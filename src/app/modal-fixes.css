/* 
 * modal-fixes.css - 模态框专用修复样式
 * 
 * 使用说明：
 * 1. 将此文件保存为 src/app/modal-fixes.css
 * 2. 在 layout.tsx 中导入：import './modal-fixes.css'
 * 3. 这个文件应该在 globals.css 之后导入
 * 
 * 修复内容：
 * - 修复所有模态框的居中问题
 * - 保持移动端和桌面端的兼容性
 * - 统一 z-index 层级管理
 * 
 * 关联组件：
 * - PixelModal
 * - BetaPasswordModal
 * - LandFragmentModal
 * - 所有使用固定定位的弹窗
 */

/* ========== 模态框通用修复 ========== */

/* 修复所有固定定位的模态框容器 */
.fixed[class*="inset-0"],
div[class*="fixed"][class*="inset-0"] {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  width: 100% !important;
  height: 100% !important;
}

/* 确保 flex 居中工作正常 */
.fixed[class*="flex"][class*="items-center"][class*="justify-center"],
div[class*="fixed"][class*="flex"][class*="items-center"][class*="justify-center"] {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
}

/* 修复 z-index 层级 */
.fixed[class*="z-50"],
div[class*="fixed"][class*="z-50"] {
  z-index: 50 !important;
}

.fixed[class*="z-[9999]"],
div[style*="z-index: 9999"],
div[style*="zIndex: 9999"] {
  z-index: 9999 !important;
}

.fixed[class*="z-[10000]"],
div[style*="z-index: 10000"],
div[style*="zIndex: 10000"] {
  z-index: 10000 !important;
}

/* 修复模态框内容容器 */
.fixed .relative,
.fixed > div > .relative {
  position: relative !important;
}

/* 确保模态框内容不会超出视窗 */
.fixed .max-w-md,
.fixed .max-w-lg,
.fixed .max-w-xl,
.fixed .max-w-2xl {
  max-width: calc(100vw - 2rem) !important;
}

.fixed .max-h-[90vh],
.fixed .max-h-[85vh] {
  max-height: 90vh !important;
  max-height: 90dvh !important; /* 使用动态视窗高度 */
}

/* ========== 桌面端优化 ========== */
@media (min-width: 768px) {
  /* 恢复桌面端的正常宽度 */
  .fixed .max-w-md {
    max-width: 28rem !important;
  }
  
  .fixed .max-w-lg {
    max-width: 32rem !important;
  }
  
  .fixed .max-w-xl {
    max-width: 36rem !important;
  }
  
  .fixed .max-w-2xl {
    max-width: 42rem !important;
  }
}

/* ========== 移动端优化 ========== */
@media (max-width: 767px) {
  /* 移动端模态框填充调整 */
  .fixed[class*="p-4"] {
    padding: 1rem !important;
  }
  
  /* 移动端模态框内容调整 */
  .fixed .p-6 {
    padding: 1rem !important;
  }
  
  /* 防止键盘弹出时模态框被推上去 */
  .fixed {
    position: fixed !important;
    transform: translate3d(0, 0, 0) !important;
  }
}

/* ========== iOS 特殊修复 ========== */
@supports (-webkit-touch-callout: none) {
  /* iOS Safari 修复 */
  .fixed {
    -webkit-transform: translateZ(0);
    -webkit-backface-visibility: hidden;
  }
  
  /* 修复 iOS 滚动问题 */
  .fixed .overflow-y-auto {
    -webkit-overflow-scrolling: touch;
    overflow-y: scroll;
  }
}

/* ========== 滚动锁定 ========== */
body.modal-open {
  overflow: hidden !important;
  position: fixed !important;
  width: 100% !important;
  height: 100% !important;
}

/* ========== 背景遮罩 ========== */
.fixed.bg-black\/50,
.fixed.bg-black\/60,
.fixed.bg-black\/70,
.fixed.bg-black\/75,
.fixed[class*="bg-black"] {
  background-color: rgba(0, 0, 0, 0.7) !important;
}

/* ========== 动画修复 ========== */
/* 如果使用了 framer-motion，确保动画不影响定位 */
.fixed > div[style*="transform"] {
  transform: none !important;
}

/* 保留必要的动画 */
.fixed .transition-all {
  transition-property: all;
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  transition-duration: 150ms;
}

/* ========== 特定组件修复 ========== */

/* PixelModal 修复 */
.pixel-modal-backdrop {
  position: fixed !important;
  inset: 0 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  z-index: 50 !important;
}

.pixel-modal-content {
  position: relative !important;
  margin: auto !important;
}

/* BetaPasswordModal 修复 */
[class*="BetaPasswordModal"],
[class*="beta-password-modal"] {
  z-index: 60 !important;
}

/* LandFragmentModal 修复 */
[class*="LandFragmentModal"],
[class*="land-fragment-modal"] {
  z-index: 70 !important;
}

/* ========== 输入框修复（防止 iOS 缩放）========== */
.fixed input[type="text"],
.fixed input[type="password"],
.fixed input[type="email"],
.fixed input[type="number"],
.fixed textarea {
  font-size: 16px !important;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
}

/* ========== 按钮点击区域优化 ========== */
.fixed button {
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  min-height: 44px; /* iOS 推荐的最小点击区域 */
}

/* ========== 调试用（可选）========== */
/* 开发时可以打开这些边框来查看布局问题 */
/*
.fixed {
  border: 2px solid red !important;
}

.fixed > div {
  border: 2px solid blue !important;
}

.fixed .relative {
  border: 2px solid green !important;
}
*/

/* ========== 修复 pixel-grid 背景层级 ========== */
.pixel-grid {
  position: fixed !important;
  inset: 0 !important;
  pointer-events: none !important;
  z-index: 0 !important;
}

/* ========== 确保内容在正确层级 ========== */
main,
.container {
  position: relative;
  z-index: 1;
}

/* ========== 修复特定的内测弹窗 ========== */
div[class*="开始自主挖矿"] {
  position: fixed !important;
  inset: 0 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
}

/* ========== 安全的 transform 重置 ========== */
.fixed .relative[style*="transform: none"] {
  transform: none !important;
}

/* ========== 响应式断点修复 ========== */
@media (max-width: 640px) {
  .fixed .sm\:p-3 {
    padding: 0.75rem !important;
  }
  
  .fixed .sm\:text-sm {
    font-size: 0.875rem !important;
  }
}

/* ========== 重要：覆盖内联样式 ========== */
.fixed[style*="opacity: 1"] {
  opacity: 1 !important;
}

.fixed .relative[style*="transform: none"] {
  transform: none !important;
}

/* ========== 修复开始自主挖矿弹窗 ========== */
.fixed .bg-\[\#0A1628\] {
  background-color: #0A1628 !important;
}

.fixed .border-gold-500 {
  border-color: #FFD700 !important;
}

/* 确保阴影显示正确 */
.fixed .shadow-\[8px_8px_0_0_rgba\(0\,0\,0\,0\.5\)\] {
  box-shadow: 8px 8px 0 0 rgba(0, 0, 0, 0.5) !important;
}
